# LocalDango

A portable local Dango network for development purpose, with full execution and consensus, indexer with PostgreSQL backend, and a GraphQL endpoint.

This uses [Docker Compose](https://docs.docker.com/compose/), so no need to configure any dependency on your computer, such as Rust, Go, or Postgres.

Genesis state and configuration files are found under [`./configs/`](./configs/) which you're free to modify.

Data generated by LocalDango are placed under `./data/`. If you feel like starting a new instance from scratch, simply delete this folder.

## Starting LocalDango

To start LocalDango with basic services:

```bash
cp env-example .env
just start
```

To start LocalDango with analytics services (includes Prometheus, Grafana):

```bash
docker compose --profile analytics up
```

To stop it, simply do CTRL+C.

## Services

### Core Services

- **Dango**: Main application server (port 8080)
- **CometBFT**: Consensus layer (port 26657)
- **PostgreSQL**: Primary database (port 5432)
- **ClickHouse**: OLAP database for analytics (ports 8123 HTTP, 9000 TCP, 9004 MySQL)

### Analytics Services (Profile: `analytics`)

- **Prometheus**: Metrics collection (port 9090)
- **Grafana**: Visualization dashboard (port 3000)
- **AlertManager**: Alert management (port 9093)
- **Push Gateway**: Metrics gateway (port 9091)

## ClickHouse Access

When running with the `analytics` profile, ClickHouse is available at:

- HTTP interface: `http://localhost:8123`
- Native TCP: `localhost:9000`
- MySQL compatibility: `localhost:9004`

Default users:

- `default` (no password) - full access
- `grug_user` (password: `grug_password`) - database access

Default database: `grug_dev`

**NOTE**: A CometBFT consensus private key is found at [`./configs/cometbft/priv_validator_key.json`](./configs/cometbft/config/priv_validator_key.json). This key is only intended for use in LocalDango. Do not reuse it for any other purpose.

## Using localdango while coding `dango` on your computer

Run those in different terminals, in order:

`cp env-example .env` (do it once, ask team for pyth access token)

1. `just start-without-dango`
2. `just start-dango` (needs to be restarted when you modify code)
3. Once the 2 other commands finished: `just start-dex-bot` (it needs dango to be already up)

You can now visit http://localhost:5081/ to view frontend.
