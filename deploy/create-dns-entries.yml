- hosts: localhost
  connection: local
  gather_facts: false
  vars:
    subs: [www, api, faucet, cometbft]
    nets: [devnet, mainnet, testnet]
    hosts_list: [ovh1, ovh2]
  tasks:
    - name: Create dashed â†’ dotted CNAMEs for all environments/hosts
      community.general.cloudflare_dns:
        zone: "{{ dango_domain }}"
        record: "{{ item.0 }}-{{ item.1 }}-{{ item.2 }}"
        type: CNAME
        value: "{{ item.2 }}.{{ dango_domain }}."
        api_token: "{{ cloudflare_api_token }}"
        state: present
      loop: "{{ subs | product(nets, hosts_list) | list }}"
      loop_control:
        label: "{{ item.0 }}-{{ item.1 }}-{{ item.2 }} -> {{ item.2 }}.{{ dango_domain }}"
